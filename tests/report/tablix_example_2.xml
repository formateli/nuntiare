<?xml version="1.0" ?>
<Nuntiare>
  <Author>Fredy Ramirez - https://formateli.com</Author>
  <Name>tablix_example_2</Name>
  <Description>Tablix example 2
    https://msdn.microsoft.com/en-us/library/ee208845(v=sql.105).aspx</Description>
  <Page/>
  <ReportParameters>
    <ReportParameter>
      <DefaultValue>aw</DefaultValue>
      <DataType>String</DataType>
      <Name>db_name</Name>
    </ReportParameter>
    <ReportParameter>
      <DefaultValue>localhost</DefaultValue>
      <DataType>String</DataType>
      <Name>db_host</Name>
    </ReportParameter>
    <ReportParameter>
      <DefaultValue>5432</DefaultValue>
      <DataType>String</DataType>
      <Name>db_port</Name>
    </ReportParameter>
    <ReportParameter>
      <DefaultValue>user</DefaultValue>
      <DataType>String</DataType>
      <Name>db_user</Name>
    </ReportParameter>
    <ReportParameter>
      <DefaultValue>passwd</DefaultValue>
      <DataType>String</DataType>
      <Name>db_password</Name>
    </ReportParameter>
    <ReportParameter>
      <DefaultValue>='dbname=' + P.db_name + \
' host=' + P.db_host + \
' port=' + P.db_port + \
' user=' + P.db_user + \
' password=' + P.db_password + \
' client_encoding=UNICODE connect_timeout=0'</DefaultValue>
      <DataType>String</DataType>
      <Name>conn_string</Name>
    </ReportParameter>
  </ReportParameters>
  <Body>
    <ReportItems>
      <Tablix>
        <Name>Address</Name>
        <Left>1in</Left>
        <DataSetName>AddressDataSet</DataSetName>
        <ToolTip>Addresses</ToolTip>
        <Visibility>
          <Hidden>=Parameters.ShowTable=False</Hidden>
        </Visibility>
        <PageBreak>
          <BreakLocation>StartAndEnd</BreakLocation>
        </PageBreak>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember/>
            <TablixMember/>
            <TablixMember/>
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <RepeatOnNewPage>true</RepeatOnNewPage>
              <DataElementName>Headers</DataElementName>
            </TablixMember>
            <TablixMember>
              <Group>
                <Name>Country</Name>
                <GroupExpressions>
                  <GroupExpression>=Fields.CountryRegion</GroupExpression>
                </GroupExpressions>
                <SortExpressions>
                  <SortExpression>
                    <Value>=Fields.CountryRegion</Value>
                    <SortDirection>Ascending</SortDirection>
                  </SortExpression>
                </SortExpressions>
              </Group>
              <TablixMembers>
                <TablixMember>
                  <RepeatOnNewPage>true</RepeatOnNewPage>
                  <DataElementName>CountryHeader</DataElementName>
                </TablixMember>
                <TablixMember>
                  <Group>
                    <Name>Details</Name>
                    <SortExpressions>
                      <SortExpression>
                        <Value>=Fields.City</Value>
                      </SortExpression>
                    </SortExpressions>
                  </Group>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>2in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.5in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>3cm</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.3in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Value>Address</Value>
                        <Name>Heading1</Name>
                        <Style>
                          <BackgroundColor>Aqua</BackgroundColor>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Value>City</Value>
                        <Name>Heading2</Name>
                        <Style>
                          <BackgroundColor>Aqua</BackgroundColor>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Value>Country</Value>
                        <Name>Heading3</Name>
                        <Style>
                          <BackgroundColor>Aqua</BackgroundColor>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>10mm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <ColSpan>3</ColSpan>
                    <ReportItems>
                      <Textbox>
                        <Value>=F.CountryRegion</Value>
                        <Name>HeadingCountry</Name>
                        <Style>
                          <Color>White</Color>
                          <BackgroundColor>Gray</BackgroundColor>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell/>
                <TablixCell/>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.6in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Value>=Fields.AddressLine1</Value>
                        <CanGrow>true</CanGrow>
                        <Name>Address</Name>
                        <Style>
                          <PaddingLeft>2pt</PaddingLeft>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Value>=Fields.City</Value>
                        <CanGrow>true</CanGrow>
                        <Name>Area</Name>
                        <Style>
                          <PaddingLeft>2pt</PaddingLeft>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Value>=Fields.CountryRegion</Value>
                        <CanGrow>true</CanGrow>
                        <Name>Country</Name>
                        <Style>
                          <PaddingLeft>2pt</PaddingLeft>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <Style>
          <Border>
            <BorderStyle>Solid</BorderStyle>
          </Border>
        </Style>
      </Tablix>
    </ReportItems>
  </Body>
  <DataSources>
    <DataSource>
      <Name>src1</Name>
      <ConnectionProperties>
        <ConnectObject>=P.conn_string</ConnectObject>
        <DataProvider>postgresql</DataProvider>
      </ConnectionProperties>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet>
      <Name>AddressDataSet</Name>
      <Query>
        <CommandText>SELECT address.addressline1, address.addressline2, address.city, address.postalcode,
stateprovince.name as stateprovince, countryregion.name as countryregion
FROM address
INNER JOIN stateprovince ON address.stateprovinceid = stateprovince.stateprovinceid
INNER JOIN countryregion ON countryregion.countryregioncode = stateprovince.countryregioncode
LIMIT 500</CommandText>
        <DataSourceName>src1</DataSourceName>
      </Query>
      <Fields>
        <Field>
          <Name>AddressLine1</Name>
          <DataField>addressline1</DataField>
        </Field>
        <Field>
          <Name>AddressLine2</Name>
          <DataField>addressline2</DataField>
        </Field>
        <Field>
          <Name>City</Name>
          <DataField>city</DataField>
        </Field>
        <Field>
          <Name>StateProvince</Name>
          <DataField>stateprovince</DataField>
        </Field>
        <Field>
          <Name>PostalCode</Name>
          <DataField>postalcode</DataField>
        </Field>
        <Field>
          <Name>CountryRegion</Name>
          <DataField>countryregion</DataField>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
</Nuntiare>
