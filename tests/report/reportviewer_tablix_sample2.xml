<?xml version="1.0" encoding="utf-8"?>
<Nuntiare>
  <Name>reportviewer_tablix_sample2</Name>
  <Author>Fredy Ramirez - https://formateli.com</Author>
  <Description>ReportViewer tablix sample 2
    http://gotreportviewer.com/tablix/index.html</Description>
  <ReportParameters>
    <ReportParameter>
      <Name>data_provider</Name>
      <DefaultValue>PostgreSQL</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>db_name</Name>
      <DefaultValue>aw</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>db_host</Name>
      <DefaultValue>localhost</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>db_port</Name>
      <DefaultValue>5432</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>db_user</Name>
      <DefaultValue>user</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>db_password</Name>
      <DefaultValue>passwd</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>conn_string</Name>
      <DefaultValue>='dbname=' + P.db_name + \
' host=' + P.db_host + \
' port=' + P.db_port + \
' user=' + P.db_user + \
' password=' + P.db_password + \
' client_encoding=UNICODE connect_timeout=0'</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>query_limit</Name>
      <DataType>Integer</DataType>
      <DefaultValue>100</DefaultValue>
    </ReportParameter>
  </ReportParameters>
  <DataSources>
    <DataSource>
      <Name>c1</Name>
      <ConnectionProperties>
        <DataProvider>=P.data_provider</DataProvider>
        <ConnectObject>=P.conn_string</ConnectObject>
      </ConnectionProperties>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet>
      <Name>Query1</Name>
      <Fields>
        <Field>
          <Name>LineTotal</Name>
          <DataField>linetotal</DataField>
        </Field>
        <Field>
          <Name>OrderDate</Name>
          <DataField>orderdate</DataField>
        </Field>
        <Field>
          <Name>ProductSubcategory_Name</Name>
          <DataField>productsubcategory_name</DataField>
        </Field>
        <Field>
          <Name>ProductCategory_Name</Name>
          <DataField>productcategory_name</DataField>
        </Field>
        <Field>
          <Name>SalesTerritory_Name</Name>
          <DataField>salesterritory_name</DataField>
        </Field>
        <Field>
          <Name>OrderYear</Name>
          <Value>=Year(CDate(F.OrderDate))</Value>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>c1</DataSourceName>
        <CommandText>='SELECT salesorderheader.orderdate, ' + \
'salesterritory.name AS salesterritory_name, ' + \
'productcategory.name AS productcategory_name, ' + \
'productsubcategory.name AS productsubcategory_name, ' + \
'salesorderdetail.linetotal ' + \
'FROM salesorderheader ' + \
'INNER JOIN salesorderdetail ON salesorderdetail.salesorderid = salesorderheader.salesorderid ' + \
'INNER JOIN product ON product.productid = salesorderdetail.productid ' + \
'INNER JOIN productsubcategory ON productsubcategory.productsubcategoryid = product.productsubcategoryid ' + \
'INNER JOIN productcategory ON productcategory.productcategoryid = productsubcategory.productcategoryid ' + \
'INNER JOIN salesterritory on salesorderheader.territoryid = salesterritory.territoryid ' + \
'LIMIT ' + str(P.query_limit)</CommandText>
      </Query>
    </DataSet>
  </DataSets>
  <Body>
    <ReportItems>
      <Tablix>
        <Name>Matrix1</Name>
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>0.8in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.8in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.82in</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.17in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>Textbox85</Name>
                        <CanGrow>true</CanGrow>
                        <Value>=Sum('F.LineTotal')</Value>
                        <Style>
                          <Format>{:,.2f}</Format>
                          <TextAlign>Right</TextAlign>
                          <FontWeight>Bold</FontWeight>
                          <PaddingRight>2pt</PaddingRight>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                            <Width>0.5pt</Width>
                          </Border>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>Textbox86</Name>
                        <CanGrow>true</CanGrow>
                        <Value>=Sum('F.LineTotal')</Value>
                        <Style>
                          <Format>{:,.2f}</Format>
                          <TextAlign>Right</TextAlign>
                          <FontWeight>Bold</FontWeight>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                            <Width>0.5pt</Width>
                          </Border>
                          <PaddingRight>2pt</PaddingRight>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>Textbox87</Name>
                        <CanGrow>true</CanGrow>
                        <Value>=Sum('F.LineTotal')</Value>
                        <Style>
                          <Format>{:,.2f}</Format>
                          <TextAlign>Right</TextAlign>
                          <FontWeight>Bold</FontWeight>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                            <Width>0.5pt</Width>
                          </Border>
                          <PaddingRight>2pt</PaddingRight>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.17in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>Matrix1_cell1</Name>
                        <Value>=Sum('F.LineTotal')</Value>
                        <Style>
                          <Format>{:,.2f}</Format>
                          <TextAlign>Right</TextAlign>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                            <Width>0.5pt</Width>
                          </Border>
                          <PaddingRight>2pt</PaddingRight>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>textbox11</Name>
                        <Value>=Sum('F.LineTotal')</Value>
                        <Style>
                          <Format>{:,.2f}</Format>
                          <TextAlign>Right</TextAlign>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                            <Width>0.5pt</Width>
                          </Border>
                          <PaddingRight>2pt</PaddingRight>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>textbox2</Name>
                        <Value>=Sum('F.LineTotal')</Value>
                        <Style>
                          <Format>{:,.2f}</Format>
                          <TextAlign>Right</TextAlign>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                            <Width>0.5pt</Width>
                          </Border>
                          <PaddingRight>2pt</PaddingRight>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.17in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>textbox6</Name>
                        <Value>=Sum('F.LineTotal')</Value>
                        <Style>
                          <Format>{:,.2f}</Format>
                          <TextAlign>Right</TextAlign>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                            <Width>0.5pt</Width>
                          </Border>
                          <FontFamily>Verdana</FontFamily>
                          <FontWeight>Bold</FontWeight>
                          <PaddingRight>2pt</PaddingRight>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>textbox9</Name>
                        <Value>=Sum('F.LineTotal')</Value>
                        <Style>
                          <Format>{:,.2f}</Format>
                          <TextAlign>Right</TextAlign>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                            <Width>0.5pt</Width>
                          </Border>
                          <FontFamily>Verdana</FontFamily>
                          <FontWeight>Bold</FontWeight>
                          <PaddingRight>2pt</PaddingRight>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>textbox8</Name>
                        <Value>=Sum('F.LineTotal')</Value>
                        <Style>
                          <Format>{:,.2f}</Format>
                          <TextAlign>Right</TextAlign>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                            <Width>0.5pt</Width>
                          </Border>
                          <FontFamily>Verdana</FontFamily>
                          <FontWeight>Bold</FontWeight>
                          <PaddingRight>2pt</PaddingRight>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember>
              <TablixHeader>
                <Size>0.17in</Size>
                <CellContents>
                  <ReportItems>
                    <Textbox>
                      <Name>Textbox22</Name>
                      <CanGrow>true</CanGrow>
                      <Value>Year</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <TopBorder>
                          <Color>DarkGray</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </TopBorder>
                        <BottomBorder>
                          <Color>DarkGray</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </BottomBorder>
                        <LeftBorder>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </LeftBorder>
                        <RightBorder>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </RightBorder>
                        <BackgroundColor>#ddddee</BackgroundColor>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </CellContents>
              </TablixHeader>
              <TablixMembers>
                <TablixMember>
                  <Group>
                    <Name>OrderYearGroup</Name>
                    <GroupExpressions>
                      <GroupExpression>=F.OrderYear</GroupExpression>
                    </GroupExpressions>
                    <SortExpressions>
                      <SortExpression>
                        <Value>=F.OrderYear</Value>
                      </SortExpression>
                    </SortExpressions>
                  </Group>
                  <TablixHeader>
                    <Size>0.17in</Size>
                    <CellContents>
                      <ReportItems>
                        <Textbox>
                          <Name>Matrix1_columnGroup1_Textbox</Name>
                          <Value>=F.OrderYear</Value>
                          <Style>
                            <TopBorder>
                              <Color>DarkGray</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </TopBorder>
                            <BottomBorder>
                              <Color>DarkGray</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </BottomBorder>
                            <LeftBorder>
                              <Color>LightGrey</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </LeftBorder>
                            <RightBorder>
                              <Color>LightGrey</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </RightBorder>
                            <BackgroundColor>#ddddee</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                          </Style>
                        </Textbox>
                      </ReportItems>
                    </CellContents>
                  </TablixHeader>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
            <TablixMember>
              <TablixHeader>
                <Size>0.17in</Size>
                <CellContents>
                  <ReportItems>
                    <Textbox>
                      <Name>Textbox23</Name>
                      <CanGrow>true</CanGrow>
                      <Value>Territory</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <TopBorder>
                          <Color>DarkGray</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </TopBorder>
                        <BottomBorder>
                          <Color>DarkGray</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </BottomBorder>
                        <LeftBorder>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </LeftBorder>
                        <RightBorder>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </RightBorder>
                        <BackgroundColor>#ddeedd</BackgroundColor>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </CellContents>
              </TablixHeader>
              <TablixMembers>
                <TablixMember>
                  <Group>
                    <Name>SalesTerritoryGroup</Name>
                    <GroupExpressions>
                      <GroupExpression>=F.SalesTerritory_Name</GroupExpression>
                    </GroupExpressions>
                    <SortExpressions>
                      <SortExpression>
                        <Value>=F.SalesTerritory_Name</Value>
                      </SortExpression>
                    </SortExpressions>
                  </Group>
                  <TablixHeader>
                    <Size>0.17in</Size>
                    <CellContents>
                      <ReportItems>
                        <Textbox>
                          <Name>Group1</Name>
                          <CanGrow>true</CanGrow>
                          <Value>=F.SalesTerritory_Name</Value>
                          <Style>
                            <TextAlign>Right</TextAlign>
                            <Border>
                              <BorderStyle>None</BorderStyle>
                            </Border>
                            <TopBorder>
                              <Color>DarkGray</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </TopBorder>
                            <BottomBorder>
                              <Color>DarkGray</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </BottomBorder>
                            <LeftBorder>
                              <Color>LightGrey</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </LeftBorder>
                            <RightBorder>
                              <Color>LightGrey</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </RightBorder>
                            <BackgroundColor>#ddeedd</BackgroundColor>
                          </Style>
                        </Textbox>
                      </ReportItems>
                    </CellContents>
                  </TablixHeader>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
            <TablixMember>
              <TablixHeader>
                <Size>0.34in</Size>
                <CellContents>
                  <ReportItems>
                    <Textbox>
                      <Name>Textbox24</Name>
                      <CanGrow>true</CanGrow>
                      <Value>Grand Total</Value>
                      <Style>
                        <TextAlign>Right</TextAlign>
                        <Border>
                          <BorderStyle>None</BorderStyle>
                        </Border>
                        <TopBorder>
                          <Color>DarkGray</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </TopBorder>
                        <BottomBorder>
                          <Color>DarkGray</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </BottomBorder>
                        <LeftBorder>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </LeftBorder>
                        <RightBorder>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </RightBorder>
                        <BackgroundColor>#dddddd</BackgroundColor>
                        <PaddingRight>2pt</PaddingRight>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </CellContents>
              </TablixHeader>
            </TablixMember>
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <Group>
                <Name>ProductCategoryGroup</Name>
                <GroupExpressions>
                  <GroupExpression>=F.ProductCategory_Name</GroupExpression>
                </GroupExpressions>
                <SortExpressions>
                  <SortExpression>
                    <Value>=F.ProductCategory_Name</Value>
                  </SortExpression>
                </SortExpressions>
              </Group>
              <TablixMembers>
                <TablixMember>
                  <TablixHeader>
                    <Size>90pt</Size>
                    <CellContents>
                      <ReportItems>
                        <Textbox>
                          <Name>ProductCategory_Name_header</Name>
                          <Value>=F.ProductCategory_Name</Value>
                          <Style>
                            <FontWeight>Bold</FontWeight>
                            <Border>
                              <BorderStyle>None</BorderStyle>
                            </Border>
                            <TopBorder>
                              <Color>DarkGray</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </TopBorder>
                            <BottomBorder>
                              <Color>DarkGray</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </BottomBorder>
                            <LeftBorder>
                              <Color>LightGrey</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </LeftBorder>
                            <RightBorder>
                              <Color>LightGrey</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </RightBorder>
                            <BackgroundColor>#dddddd</BackgroundColor>
                          </Style>
                        </Textbox>
                      </ReportItems>
                    </CellContents>
                  </TablixHeader>
                </TablixMember>
                <TablixMember>
                  <Group>
                    <Name>ProductSubcategoryGroup</Name>
                    <GroupExpressions>
                      <GroupExpression>=F.ProductSubcategory_Name</GroupExpression>
                    </GroupExpressions>
                    <SortExpressions>
                      <SortExpression>
                        <Value>=F.ProductSubcategory_Name</Value>
                      </SortExpression>
                    </SortExpressions>
                  </Group>
                  <TablixHeader>
                    <Size>90pt</Size>
                    <CellContents>
                      <ReportItems>
                        <Textbox>
                          <Name>ProductSubcategory_Name_header</Name>
                          <Value>=F.ProductSubcategory_Name</Value>
                          <Style>
                            <PaddingLeft>32pt</PaddingLeft>
                            <Border>
                              <BorderStyle>None</BorderStyle>
                            </Border>
                            <TopBorder>
                              <Color>DarkGray</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </TopBorder>
                            <BottomBorder>
                              <Color>DarkGray</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </BottomBorder>
                            <LeftBorder>
                              <Color>LightGrey</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </LeftBorder>
                            <RightBorder>
                              <Color>LightGrey</Color>
                              <BorderStyle>Solid</BorderStyle>
                              <Width>0.5pt</Width>
                            </RightBorder>
                            <BackgroundColor>#dddddd</BackgroundColor>
                          </Style>
                        </Textbox>
                      </ReportItems>
                    </CellContents>
                  </TablixHeader>
                  <Visibility>
                    <Hidden>true</Hidden>
                    <ToggleItem>Matrix1_rowGroup1_Textbox</ToggleItem>
                  </Visibility>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
            <TablixMember>
              <TablixHeader>
                <Size>90pt</Size>
                <CellContents>
                  <ReportItems>
                    <Textbox>
                      <Name>Matrix1_rowGroup1_Subtotal</Name>
                      <Value>Grand Total</Value>
                      <Style>
                        <FontWeight>Bold</FontWeight>
                        <Border>
                          <BorderStyle>None</BorderStyle>
                        </Border>
                        <TopBorder>
                          <Color>DarkGray</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </TopBorder>
                        <BottomBorder>
                          <Color>DarkGray</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </BottomBorder>
                        <LeftBorder>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </LeftBorder>
                        <RightBorder>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                          <Width>0.5pt</Width>
                        </RightBorder>
                        <BackgroundColor>#dddddd</BackgroundColor>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </CellContents>
              </TablixHeader>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <RepeatColumnHeaders>true</RepeatColumnHeaders>
        <RepeatRowHeaders>true</RepeatRowHeaders>
        <DataSetName>Query1</DataSetName>
        <Top>2pt</Top>
        <Left>2pt</Left>
        <Height>0.85in</Height>
        <Width>3.78458in</Width>
        <Style/>
      </Tablix>
    </ReportItems>
    <Style/>
  </Body>
  <Page>
    <Style/>
  </Page>
</Nuntiare>
