<?xml version="1.0" encoding="UTF-8"?>

<!--
 This file is part of Nuntiare project. 
 The COPYRIGHT file at the top level of this repository 
 contains the full copyright notices and license terms.
-->

<Report>
  <Name>Employees</Name>
  <Description>Simple employee report</Description>
  <Author>Fredy Ramirez</Author>
  <PageHeight>11in</PageHeight>
  <PageWidth>8.5in</PageWidth>
  <Width>8.5in</Width>
  <TopMargin>1cm</TopMargin>
  <LeftMargin>1cm</LeftMargin>
  <RightMargin>1cm</RightMargin>
  <BottomMargin>1cm</BottomMargin>

  <Imports>
    <Import>
      <!-- Example of how to use Modules. See PageFooter -->
      <Name>my_os</Name>
      <Module>os</Module>
    </Import>
  </Imports>

  <ReportParameters>
      <ReportParameter>
          <Name>data_source</Name>
          <DataType>String</DataType>
          <CanBeNone>false</CanBeNone>
          <AllowBlank>false</AllowBlank>
          <DefaultValue>PostgreSQL</DefaultValue>
      </ReportParameter>
      <ReportParameter>
          <Name>db_password</Name>
          <DataType>String</DataType>
          <CanBeNone>false</CanBeNone>
          <AllowBlank>false</AllowBlank>
          <DefaultValue>None</DefaultValue>
      </ReportParameter>
      <ReportParameter>
          <Name>conn_string</Name>
          <DataType>String</DataType>
          <CanBeNone>false</CanBeNone>
          <AllowBlank>false</AllowBlank>
          <DefaultValue>='dbname=northwind host=localhost port=5432 user=postgres password=' + Parameters['db_password'] + ' client_encoding=UNICODE connect_timeout=0'</DefaultValue>
      </ReportParameter>
  </ReportParameters>

  <DataSources>
    <DataSource>
      <Name>DS1</Name>
      <ConnectionProperties>
        <DataProvider>=Parameters['data_source']</DataProvider>
        <ConnectString>=Parameters['conn_string']</ConnectString>
        <IntegratedSecurity>false</IntegratedSecurity>
      </ConnectionProperties>
    </DataSource>
  </DataSources>

  <DataSets>
    <DataSet>
      <Name>DataEmployee</Name>
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>="SELECT employeeid, firstname, lastname, birthdate, country, city FROM employees"</CommandText>
      </Query>

      <Fields>
        <Field>
          <Name>id</Name>
          <DataField>employeeid</DataField>
        </Field>
        <Field>
          <Name>firstname</Name>
          <DataField>firstname</DataField>
        </Field>
        <Field>
          <Name>lastname</Name>
          <DataField>lastname</DataField>
        </Field>
        <Field>
          <Name>dob</Name>
          <DataField>birthdate</DataField>
        </Field>
        <Field>
          <Name>country</Name>
          <DataField>country</DataField>
        </Field>
        <Field>
          <Name>city</Name>
          <DataField>city</DataField>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>

  <PageHeader>
    <Height>1cm</Height>
    <PrintOnFirstPage>true</PrintOnFirstPage>
    <PrintOnLastPage>true</PrintOnLastPage>
    <ReportItems>
      <Textbox>
        <Name>title</Name>
        <Height>21pt</Height>
        <Width>490pt</Width>
        <Value>Employees Report</Value>
        <Left>0.0pt</Left>
        <Top>0.0pt</Top>
        <Style>
          <FontWeight>Bold</FontWeight>
          <FontSize>16pt</FontSize>
        </Style>
      </Textbox>
    </ReportItems>
  </PageHeader>
  <Body>
    <Height>9in</Height>
    <Columns>1</Columns>
    <ReportItems>
      <Table>
        <Name>TableEmployees</Name>
        <DataSetName>DataEmployee</DataSetName>
        <NoRows>Query returned no rows!</NoRows>
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
        </Style>
        <Columns>
          <Column>
            <Width>1cm</Width>
          </Column>
          <Column>
            <Width>1cm</Width>
          </Column>
          <Column>
            <Width>4cm</Width>
          </Column>
          <Column>
            <Width>4cm</Width>
          </Column>
          <Column>
            <Width>3cm</Width>
          </Column>
        </Columns>
        <Header>
          <Rows>
            <Row>
              <Height>15mm</Height>
              <Cells>
                <Cell>
                  <ReportItems>
                    <Textbox>
                      <Name>no</Name>
                      <Value></Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>None</Default>
                        </BorderStyle>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </Cell>
                <Cell>
                  <ReportItems>
                    <Textbox>
                      <Name>titleid</Name>
                      <Value>ID</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </Cell>
                <Cell>
                  <ReportItems>
                    <Textbox>
                      <Name>titlefname</Name>
                      <Value>FIRST NAME</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </Cell>
                <Cell>
                  <ReportItems>
                    <Textbox>
                      <Name>titlelname</Name>
                      <Value>LAST NAME</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </Cell>
                <Cell>
                  <ReportItems>
                    <Textbox>
                      <Name>titledob</Name>
                      <Value>BIRTHDAY</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </Cell>
              </Cells>
            </Row>
          </Rows>
        </Header>
        <TableGroups>
          <TableGroup>
            <Grouping>
              <Name>country</Name>
              <GroupExpressions>
                <GroupExpression>=Fields['country']</GroupExpression>
              </GroupExpressions>
              <PageBreakAtStart>false</PageBreakAtStart>
              <PageBreakAtEnd>false</PageBreakAtEnd>
            </Grouping>
            <Sorting>
                <SortBy>
                    <SortExpression>=Fields['country']</SortExpression>
                </SortBy> 
            </Sorting>
            <Header>
              <Rows>
                <Row>
                  <Height>1cm</Height>
                  <Cells>
                    <Cell>
                      <ReportItems>
                        <Textbox>
                          <Name>txtcountry</Name>
                          <Value>=Fields['country']</Value>
                          <CanGrow>true</CanGrow>
                          <Style>
                            <BorderStyle>
                              <Default>None</Default>
                              <Left>None</Left>
                              <Right>None</Right>
                              <Top>None</Top>
                              <Bottom>None</Bottom>
                            </BorderStyle>
                            <BorderColor />
                            <BorderWidth />
                            <Color>Blue</Color>
                            <FontWeight>Bold</FontWeight>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </ReportItems>
                      <ColSpan>5</ColSpan>
                    </Cell>
                  </Cells>
                </Row>
              </Rows>
              <RepeatOnNewPage>false</RepeatOnNewPage>
            </Header>
          </TableGroup>
          <TableGroup>
            <Grouping>
              <Name>city</Name>
              <GroupExpressions>
                <GroupExpression>=Fields['city']</GroupExpression>
              </GroupExpressions>
              <PageBreakAtStart>false</PageBreakAtStart>
              <PageBreakAtEnd>false</PageBreakAtEnd>
            </Grouping>
            <Sorting>
                <SortBy>
                    <SortExpression>=Fields['city']</SortExpression>
                </SortBy> 
            </Sorting>
            <Header>
              <Rows>
                <Row>
                  <Height>1cm</Height>
                  <Cells>
                    <Cell>
                      <ReportItems>
                        <Textbox>
                          <Name>txtcity</Name>
                          <Value>='-- ' + Fields['city']</Value>
                          <CanGrow>true</CanGrow>
                          <Style>
                            <BorderStyle>
                              <Default>None</Default>
                              <Left>None</Left>
                              <Right>None</Right>
                              <Top>None</Top>
                              <Bottom>None</Bottom>
                            </BorderStyle>
                            <BorderColor />
                            <BorderWidth />
                            <Color>Red</Color>
                            <FontWeight>Bold</FontWeight>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                      </ReportItems>
                      <ColSpan>5</ColSpan>
                    </Cell>
                  </Cells>
                </Row>
              </Rows>
              <RepeatOnNewPage>false</RepeatOnNewPage>
            </Header>
          </TableGroup>
        </TableGroups>
        <Details>
          <Rows>
            <Row>
              <Height>12 pt</Height>
              <Cells>
                <Cell>
                  <ReportItems>
                    <Textbox>
                      <Name>txtno</Name>
                      <Value>=Data().row_number()</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BackgroundColor>="White" if Data().row_number() % 2 else "Green"</BackgroundColor>
                        <BorderStyle>
                          <Default>None</Default>
                          <Left>None</Left>
                          <Right>None</Right>
                          <Top>None</Top>
                          <Bottom>None</Bottom>
                        </BorderStyle>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </Cell>
                <Cell>
                  <ReportItems>
                    <Textbox>
                      <Name>txtid</Name>
                      <Value>=Fields['id']</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BackgroundColor>="White" if Data().row_number() % 2 else "Green"</BackgroundColor>
                        <BorderStyle>
                          <Default>None</Default>
                          <Left>None</Left>
                          <Right>None</Right>
                          <Top>None</Top>
                          <Bottom>None</Bottom>
                        </BorderStyle>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </Cell>
                <Cell>
                  <ReportItems>
                    <Textbox>
                      <Name>txtfname</Name>
                      <Value>=Fields['firstname']</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BackgroundColor>="White" if Data().row_number() % 2 else "Green"</BackgroundColor>
                        <BorderStyle>
                          <Default>None</Default>
                          <Left>None</Left>
                          <Right>None</Right>
                          <Top>None</Top>
                          <Bottom>None</Bottom>
                        </BorderStyle>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </Cell>
                <Cell>
                  <ReportItems>
                    <Textbox>
                      <Name>txtlname</Name>
                      <Value>=Fields['lastname']</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BackgroundColor>="White" if Data().row_number() % 2 else "Green"</BackgroundColor>
                        <BorderStyle>
                          <Default>None</Default>
                          <Left>None</Left>
                          <Right>None</Right>
                          <Top>None</Top>
                          <Bottom>None</Bottom>
                        </BorderStyle>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </Cell>
                <Cell>
                  <ReportItems>
                    <Textbox>
                      <Name>txtfdob</Name>
                      <Value>=Fields['dob']</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BackgroundColor>="White" if Data().row_number() % 2 else "Green"</BackgroundColor>
                        <BorderStyle>
                          <Default>None</Default>
                          <Left>None</Left>
                          <Right>None</Right>
                          <Top>None</Top>
                          <Bottom>None</Bottom>
                        </BorderStyle>
                        <Format>{:%m-%d-%Y}</Format>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </Cell>
              </Cells>
            </Row>
          </Rows>
          <Sorting>
              <SortBy>
                  <SortExpression>=Fields['firstname']</SortExpression>
                  <SortDirection>Descending</SortDirection>
              </SortBy> 
          </Sorting>
        </Details>
      </Table>
    </ReportItems>
  </Body>
  <PageFooter>
    <Height>1cm</Height>
    <PrintOnFirstPage>true</PrintOnFirstPage>
    <PrintOnLastPage>true</PrintOnLastPage>
    <ReportItems>
      <Textbox>
        <Name>os_name</Name>
        <Height>21pt</Height>
        <Width>490pt</Width>
        <Value>='OS: ' + Modules['my_os'].name</Value>
        <Left>0.0pt</Left>
        <Top>0.0pt</Top>
        <Style>
          <FontWeight>Bold</FontWeight>
          <FontSize>10pt</FontSize>
        </Style>
      </Textbox>
    </ReportItems>
  </PageFooter>
</Report>

