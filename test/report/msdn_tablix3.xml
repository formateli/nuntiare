<?xml version="1.0" encoding="utf-8"?>
<Nuntiare>
  <Name>msdn_tablix_sample3</Name>
  <Description>MSDN tablix sample 3
https://msdn.microsoft.com/en-us/library/ee240480(v=sql.105).aspx</Description>
  <Page>
    <PageHeight>28cm</PageHeight>
    <PageWidth>21.5cm</PageWidth>
    <TopMargin>1cm</TopMargin>
    <BottomMargin>1cm</BottomMargin>
    <LeftMargin>1cm</LeftMargin>
    <RightMargin>1cm</RightMargin>
    <Style/>
  </Page>
  <ReportParameters>
    <ReportParameter>
      <Name>data_provider</Name>
      <DefaultValue>PostgreSQL</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>db_name</Name>
      <DefaultValue>aw</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>db_host</Name>
      <DefaultValue>localhost</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>db_port</Name>
      <DefaultValue>5432</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>db_user</Name>
      <DefaultValue>user</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>db_password</Name>
      <DefaultValue>passwd</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>conn_string</Name>
      <DefaultValue>='dbname=' + P.db_name + \
' host=' + P.db_host + \
' port=' + P.db_port + \
' user=' + P.db_user + \
' password=' + P.db_password + \
' client_encoding=UNICODE connect_timeout=0'</DefaultValue>
      <DataType>String</DataType>
    </ReportParameter>
    <ReportParameter>
      <Name>query_limit</Name>
      <DataType>Integer</DataType>
      <DefaultValue>100</DefaultValue>
    </ReportParameter>
  </ReportParameters>
  <DataSources>
    <DataSource>
      <Name>c1</Name>
      <ConnectionProperties>
        <DataProvider>=P.data_provider</DataProvider>
        <ConnectObject>=P.conn_string</ConnectObject>
      </ConnectionProperties>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet>
      <Name>Sales</Name>
      <Query>
        <DataSourceName>c1</DataSourceName>
        <CommandText>='SELECT salesorderheader.orderdate, ' + \
'salesorderheader.salespersonid, ' + \
'product.name, ' + \
'product.listprice, ' + \
'product.standardcost, ' + \
'salesorderdetail.orderqty, ' + \
'productcategory.name AS productcategory_name, ' + \
'salesorderdetail.linetotal ' + \
'FROM salesorderheader ' + \
'INNER JOIN salesorderdetail ON salesorderdetail.salesorderid = salesorderheader.salesorderid ' + \
'INNER JOIN product ON product.productid = salesorderdetail.productid ' + \
'INNER JOIN productsubcategory ON productsubcategory.productsubcategoryid = product.productsubcategoryid ' + \
'INNER JOIN productcategory ON productcategory.productcategoryid = productsubcategory.productcategoryid ' + \
'LIMIT ' + str(P.query_limit)</CommandText>
      </Query>
      <Fields>
        <Field>
          <Name>OrderDate</Name>
          <DataField>orderdate</DataField>
        </Field>
        <Field>
          <Name>ProductCategoryName</Name>
          <DataField>productcategory_name</DataField>
        </Field>
        <Field>
          <Name>Name</Name>
          <DataField>name</DataField>
        </Field>
        <Field>
          <Name>ListPrice</Name>
          <DataField>listprice</DataField>
        </Field>
        <Field>
          <Name>StandardCost</Name>
          <DataField>standardcost</DataField>
        </Field>
        <Field>
          <Name>OrderQty</Name>
          <DataField>orderqty</DataField>
        </Field>
        <Field>
          <Name>salespersonid</Name>
          <DataField>salespersonid</DataField>
        </Field>
        <Field>
          <Name>SalesPerson</Name>
          <Value>=str(F.salespersonid)</Value>
        </Field>
        <Field>
          <Name>OrderMonth</Name>
          <Value>=Month(CDate(F.OrderDate))</Value>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <Body>
    <ReportItems>
      <Tablix>
        <Name>Tablix3</Name>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember>
              <Group>
                <Name>SalesPerson</Name>
                <GroupExpressions>
                  <GroupExpression>=F.SalesPerson</GroupExpression>
                </GroupExpressions>
                <SortExpressions>
                  <SortExpression>
                    <Value>=F.SalesPerson</Value>
                  </SortExpression>
                </SortExpressions>
              </Group>
              <TablixHeader>
                <Size>0.48438in</Size>
                <CellContents>
                  <ReportItems>
                    <Textbox>
                      <Name>SalesPerson</Name>
                      <CanGrow>true</CanGrow>
                      <Value>=F.SalesPerson</Value>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                        </Border>
                        <BackgroundColor>Aqua</BackgroundColor>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </CellContents>
              </TablixHeader>
              <TablixMembers>
                <TablixMember>
                  <TablixHeader>
                    <Size>0.45833in</Size>
                    <CellContents>
                      <ReportItems>
                        <Textbox>
                          <Name>Textbox8</Name>
                          <CanGrow>false</CanGrow>
                          <Value>List Price</Value>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <BorderStyle>Solid</BorderStyle>
                            </Border>
                            <BackgroundColor>Aqua</BackgroundColor>
                          </Style>
                        </Textbox>
                      </ReportItems>
                    </CellContents>
                  </TablixHeader>
                </TablixMember>
                <TablixMember>
                  <TablixHeader>
                    <Size>0.45833in</Size>
                    <CellContents>
                      <ReportItems>
                        <Textbox>
                          <Name>Textbox9</Name>
                          <CanGrow>false</CanGrow>
                          <Value>Standard Cost</Value>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <BorderStyle>Solid</BorderStyle>
                            </Border>
                            <BackgroundColor>Aqua</BackgroundColor>
                          </Style>
                        </Textbox>
                      </ReportItems>
                    </CellContents>
                  </TablixHeader>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
            <TablixMember>
              <TablixHeader>
                <Size>0.94271in</Size>
                <CellContents>
                  <ReportItems>
                    <Textbox>
                      <Name>OrdersColumnHeader</Name>
                      <CanGrow>true</CanGrow>
                      <Value>Total Orders</Value>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                        </Border>
                        <BackgroundColor>Pink</BackgroundColor>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </CellContents>
              </TablixHeader>
            </TablixMember>
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <Group>
                <Name>CategoryGroup</Name>
                <GroupExpressions>
                  <GroupExpression>=F.ProductCategoryName</GroupExpression>
                </GroupExpressions>
                <SortExpressions>
                  <SortExpression>
                    <Value>=F.ProductCategoryName</Value>
                  </SortExpression>
                </SortExpressions>
              </Group>
              <TablixHeader>
                <Size>1in</Size>
                <CellContents>
                  <ReportItems>
                    <Textbox>
                      <Name>CategoryRowHeader</Name>
                      <CanGrow>true</CanGrow>
                      <Value>=F.ProductCategoryName</Value>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                        </Border>
                        <BackgroundColor>Cornsilk</BackgroundColor>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </CellContents>
              </TablixHeader>
              <TablixMembers>
                <TablixMember>
                  <TablixHeader>
                    <Size>3in</Size>
                    <CellContents>
                      <ReportItems>
                        <Textbox>
                          <Name>ProductHeaderRowHeader</Name>
                          <CanGrow>true</CanGrow>
                          <Value>First order received</Value>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <BorderStyle>Solid</BorderStyle>
                            </Border>
                          </Style>
                        </Textbox>
                      </ReportItems>
                    </CellContents>
                  </TablixHeader>
                  <RepeatOnNewPage>true</RepeatOnNewPage>
                </TablixMember>
                <TablixMember>
                  <Group>
                    <Name>Product</Name>
                    <GroupExpressions>
                      <GroupExpression>=F.Name</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <TablixHeader>
                    <Size>3in</Size>
                    <CellContents>
                      <ReportItems>
                        <Textbox>
                          <Name>ProductRowHeader</Name>
                          <CanGrow>true</CanGrow>
                          <Value>=F.Name</Value>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <BorderStyle>Solid</BorderStyle>
                            </Border>
                            <BackgroundColor>Yellow</BackgroundColor>
                          </Style>
                        </Textbox>
                      </ReportItems>
                    </CellContents>
                  </TablixHeader>
                </TablixMember>
                <TablixMember>
                  <TablixHeader>
                    <Size>3in</Size>
                    <CellContents>
                      <ReportItems>
                        <Textbox>
                          <Name>ProductFooterRowHeader</Name>
                          <CanGrow>true</CanGrow>
                          <Value>Total</Value>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <BorderStyle>Solid</BorderStyle>
                            </Border>
                            <TopBorder>
                              <Color>Black</Color>
                            </TopBorder>
                            <BottomBorder>
                              <Color>Black</Color>
                              <Width>2pt</Width>
                            </BottomBorder>
                          </Style>
                        </Textbox>
                      </ReportItems>
                    </CellContents>
                  </TablixHeader>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>

        <TablixCorner>
          <TablixCornerRows>
            <TablixCornerRow>
              <TablixCornerCell>
                <CellContents>
                  <ReportItems>
                    <Textbox>
                      <Name>Textbox4</Name>
                      <CanGrow>true</CanGrow>
                      <Value>Bicycle sales for June 2004</Value>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                        </Border>
                        <BackgroundColor>Lime</BackgroundColor>
                      </Style>
                    </Textbox>
                  </ReportItems>
                  <ColSpan>2</ColSpan>
                </CellContents>
              </TablixCornerCell>
              <TablixCornerCell/>
            </TablixCornerRow>
            <TablixCornerRow>
              <TablixCornerCell>
                <CellContents>
                  <ReportItems>
                    <Textbox>
                      <Name>Textbox18</Name>
                      <CanGrow>true</CanGrow>
                      <Value>Category</Value>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                        </Border>
                        <BackgroundColor>Lime</BackgroundColor>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </CellContents>
              </TablixCornerCell>
              <TablixCornerCell>
                <CellContents>
                  <ReportItems>
                    <Textbox>
                      <Name>Textbox7</Name>
                      <CanGrow>true</CanGrow>
                      <Value>Product Name</Value>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <BorderStyle>Solid</BorderStyle>
                        </Border>
                        <BackgroundColor>Lime</BackgroundColor>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </CellContents>
              </TablixCornerCell>
            </TablixCornerRow>
          </TablixCornerRows>
        </TablixCorner>

        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>1.47396in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.29167in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1in</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.25in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>OrderDate</Name>
                        <CanGrow>true</CanGrow>
                        <Value>=First('F.OrderDate')</Value>
                        <Style>
                          <Format>{:%d-%m-%Y}</Format>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                        </Style>
                      </Textbox>
                    </ReportItems>
                    <ColSpan>2</ColSpan>
                  </CellContents>
                </TablixCell>
                <TablixCell/>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>Textbox40</Name>
                        <CanGrow>true</CanGrow>
                        <Value/>
                        <Style>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                          <BackgroundColor>Pink</BackgroundColor>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.39062in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>ListPrice</Name>
                        <CanGrow>true</CanGrow>
                        <Value>=Sum('F.ListPrice')</Value>
                        <Style>
                          <Format>{:,.2f}</Format>
                          <TextAlign>Right</TextAlign>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>StandardCost</Name>
                        <CanGrow>true</CanGrow>
                        <Value>=Sum('F.StandardCost')</Value>
                        <Style>
                          <Format>{:,.2f}</Format>
                          <TextAlign>Right</TextAlign>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>OrderQty</Name>
                        <CanGrow>true</CanGrow>
                        <Value>=Sum('F.OrderQty')</Value>
                        <Style>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                          <BackgroundColor>Pink</BackgroundColor>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.25in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>ListPrice1</Name>
                        <CanGrow>true</CanGrow>
                        <Value>=Sum('F.ListPrice')</Value>
                        <Style>
                          <Format>{:,.2f}</Format>
                          <TextAlign>Right</TextAlign>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                          <TopBorder>
                            <Color>Black</Color>
                          </TopBorder>
                          <BottomBorder>
                            <Color>Black</Color>
                            <Width>2pt</Width>
                          </BottomBorder>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>StandardCost1</Name>
                        <CanGrow>true</CanGrow>
                        <Value>=Sum('F.StandardCost')</Value>
                        <Style>
                          <Format>{:,.2f}</Format>
                          <TextAlign>Right</TextAlign>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                          <TopBorder>
                            <Color>Black</Color>
                          </TopBorder>
                          <BottomBorder>
                            <Color>Black</Color>
                            <Width>2pt</Width>
                          </BottomBorder>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <ReportItems>
                      <Textbox>
                        <Name>Textbox42</Name>
                        <CanGrow>true</CanGrow>
                        <Value>=Sum('F.OrderQty')</Value>
                        <Style>
                          <Border>
                            <Color>LightGrey</Color>
                            <BorderStyle>Solid</BorderStyle>
                          </Border>
                          <TopBorder>
                            <Color>Black</Color>
                          </TopBorder>
                          <BottomBorder>
                            <Color>Black</Color>
                            <Width>2pt</Width>
                          </BottomBorder>
                          <BackgroundColor>Pink</BackgroundColor>
                        </Style>
                      </Textbox>
                    </ReportItems>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <DataSetName>Sales</DataSetName>
        <Style>
          <Border>
            <BorderStyle>None</BorderStyle>
          </Border>
        </Style>
      </Tablix>
    </ReportItems>
    <Style/>
  </Body>
</Nuntiare>
